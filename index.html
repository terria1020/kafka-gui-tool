<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
  <title>Kafka GUI Tool</title>
  <link rel="stylesheet" href="renderer/styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="app-header">
      <h1>Kafka GUI Tool</h1>
      <div class="header-actions">
        <button id="settings-btn" class="btn btn-secondary btn-icon" title="Settings">&#9881;</button>
        <button id="add-tab-btn" class="btn btn-primary" title="ìƒˆ íƒ­ ì¶”ê°€">+</button>
      </div>
    </header>

    <!-- Kafka Tools Warning -->
    <div id="kafka-tools-warning" class="warning-banner hidden">
      <span class="warning-icon">âš ï¸</span>
      <span class="warning-text">Kafka CLI ë„êµ¬ê°€ PATHì— ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.</span>
      <button class="btn-close" onclick="this.parentElement.classList.add('hidden')">&times;</button>
    </div>

    <!-- Tab Bar -->
    <nav class="tab-bar">
      <div id="tabs-container" class="tabs-container">
        <!-- íƒ­ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div id="tab-panels-container">
        <!-- íƒ­ íŒ¨ë„ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
      </div>
    </main>
  </div>

  <!-- Tab Panel Template -->
  <template id="tab-panel-template">
    <div class="tab-panel" data-tab-id="">
      <!-- Connection Settings -->
      <section class="connection-section">
        <div class="form-row">
          <div class="form-group">
            <label for="broker-input">Broker(s)</label>
            <input type="text" class="broker-input" placeholder="host1:9092,host2:9092,host3:9092" value="localhost:9092">
          </div>
          <div class="form-group">
            <label for="topic-input">Topic</label>
            <input type="text" class="topic-input" placeholder="event-result">
          </div>
          <div class="form-group">
            <label for="group-input">Group ID (ì„ íƒ)</label>
            <input type="text" class="group-input" placeholder="kafka-gui-group">
          </div>
        </div>
        <div class="mode-selector">
          <label class="radio-label">
            <input type="radio" name="mode" value="consumer" class="mode-radio" checked>
            <span>Consumer</span>
          </label>
          <label class="radio-label">
            <input type="radio" name="mode" value="producer" class="mode-radio">
            <span>Producer</span>
          </label>
          <button class="btn btn-secondary btn-sm util-btn">Util</button>
        </div>
      </section>

      <!-- Consumer Section -->
      <section class="consumer-section mode-section">
        <div class="consumer-controls">
          <div class="filter-group">
            <input type="text" class="filter-input" placeholder="í‚¤ì›Œë“œ ê²€ìƒ‰ (key/value)">
            <input type="text" class="value-filter-input" placeholder="Value JSONPath ($.data.name)">
            <button class="btn btn-icon filter-btn" title="í•„í„° ì ìš©">ğŸ”</button>
          </div>
          <div class="action-buttons">
            <button class="btn btn-success start-btn">Start</button>
            <button class="btn btn-warning pause-btn" disabled>Pause</button>
            <button class="btn btn-danger stop-btn" disabled>Stop</button>
            <button class="btn btn-secondary clear-btn">Clear</button>
            <div class="export-dropdown">
              <button class="btn btn-secondary export-btn">Export â–¾</button>
              <div class="export-menu hidden">
                <button class="export-json-btn">JSON</button>
                <button class="export-txt-btn">TXT</button>
              </div>
            </div>
          </div>
        </div>
        <div class="status-bar">
          <span class="status-indicator disconnected"></span>
          <span class="status-text">Disconnected</span>
          <span class="message-count">Messages: 0</span>
        </div>
        <div class="messages-container">
          <table class="messages-table">
            <thead>
              <tr>
                <th class="col-timestamp">Timestamp</th>
                <th class="col-partition">Partition</th>
                <th class="col-offset">Offset</th>
                <th class="col-key">Key</th>
                <th class="col-value">Value</th>
              </tr>
            </thead>
            <tbody class="messages-body">
              <!-- ë©”ì‹œì§€ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Producer Section -->
      <section class="producer-section mode-section hidden">
        <div class="producer-form">
          <div class="form-group">
            <label>Key (ì„ íƒ)</label>
            <input type="text" class="producer-key-input" placeholder="ë©”ì‹œì§€ í‚¤ (ì„ íƒì‚¬í•­)">
          </div>
          <div class="form-group">
            <label>Value</label>
            <textarea class="producer-value-input" rows="10" placeholder='{"field": "value"}'></textarea>
          </div>
          <div class="repeat-settings">
            <label class="checkbox-label">
              <input type="checkbox" class="repeat-checkbox">
              <span>ë°˜ë³µ ì „ì†¡</span>
            </label>
            <div class="repeat-options hidden">
              <div class="form-group-inline">
                <label>ê°„ê²© (ms)</label>
                <input type="number" class="repeat-interval-input" value="1000" min="100">
              </div>
              <div class="form-group-inline">
                <label>íšŸìˆ˜</label>
                <input type="number" class="repeat-count-input" value="10" min="1">
              </div>
            </div>
          </div>
          <div class="producer-actions">
            <button class="btn btn-primary send-btn">Send Message</button>
            <button class="btn btn-danger cancel-send-btn hidden">Cancel</button>
            <span class="send-status"></span>
          </div>
          <div class="send-log-container hidden">
            <div class="send-log-header">
              <span>ì „ì†¡ ë¡œê·¸</span>
              <button class="btn btn-icon clear-log-btn" title="ë¡œê·¸ ì§€ìš°ê¸°">ğŸ—‘ï¸</button>
            </div>
            <div class="send-log"></div>
          </div>
        </div>
      </section>
    </div>
  </template>

  <!-- Message Detail Modal -->
  <div id="message-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Message Detail</h3>
        <button class="btn-close modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="detail-row">
          <label>Timestamp:</label>
          <span id="modal-timestamp"></span>
        </div>
        <div class="detail-row">
          <label>Partition:</label>
          <span id="modal-partition"></span>
        </div>
        <div class="detail-row">
          <label>Offset:</label>
          <span id="modal-offset"></span>
        </div>
        <div class="detail-row">
          <label>Key:</label>
          <span id="modal-key"></span>
        </div>
        <div class="detail-row">
          <label>Value:</label>
          <pre id="modal-value" class="json-viewer"></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal hidden">
    <div class="modal-content settings-modal-content">
      <div class="modal-header">
        <h3>Settings</h3>
        <button class="btn-close modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-form">
          <div class="form-group">
            <label for="max-messages-input">Maximum Messages</label>
            <p class="form-help">íƒ­ë‹¹ ë©”ëª¨ë¦¬ì— ë³´ê´€í•  ìµœëŒ€ ë©”ì‹œì§€ ìˆ˜ (10 - 100,000)</p>
            <input
              type="number"
              id="max-messages-input"
              class="settings-input"
              min="10"
              max="100000"
              value="1000"
              step="100"
            >
          </div>
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="check-topic-input" checked>
              <span>Check Topic Before Send/Consume</span>
            </label>
            <p class="form-help">ì „ì†¡/ì†Œë¹„ ì „ì— í† í”½ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. ë¹„í™œì„±í™” ì‹œ ë” ë¹ ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="settings-cancel-btn" class="btn btn-secondary">Cancel</button>
        <button id="settings-save-btn" class="btn btn-primary">Save</button>
      </div>
    </div>
  </div>

  <!-- Util Modal -->
  <div id="util-modal" class="modal hidden">
    <div class="modal-content util-modal-content">
      <div class="modal-header">
        <h3>Kafka Utilities</h3>
        <button class="btn-close modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="util-tabs">
          <button class="util-tab active" data-util="broker">Broker ìƒíƒœ</button>
          <button class="util-tab" data-util="topics">í† í”½ ëª©ë¡</button>
          <button class="util-tab" data-util="groups">ì†Œë¹„ ê·¸ë£¹</button>
          <button class="util-tab" data-util="cluster">í´ëŸ¬ìŠ¤í„° ì •ë³´</button>
        </div>
        <div class="util-content">
          <div class="util-panel active" data-util="broker">
            <div class="util-result"></div>
          </div>
          <div class="util-panel" data-util="topics">
            <div class="util-result"></div>
          </div>
          <div class="util-panel" data-util="groups">
            <div class="util-result"></div>
          </div>
          <div class="util-panel" data-util="cluster">
            <div class="util-result"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary util-refresh-btn">Refresh</button>
        <button class="btn btn-secondary modal-close">Close</button>
      </div>
    </div>
  </div>

  <script src="renderer/app.js"></script>
</body>
</html>
